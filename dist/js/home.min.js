"use strict";function _objectSpread(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},a=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.forEach(function(t){_defineProperty(n,t,e[t])})}return n}function _defineProperty(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}!function(){var e={icon:"success",position:"bottom-right",allowToastClose:!1,stack:!1,loader:!1,hideAfter:2e3,textAlign:"center"};function t(a){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o={pageNum:1,pageSize:5,integralType:0},n=$(a),r=n.find("tbody");s(a,o,r);var i=n.find("a[data-rank]");i.on("click",function(){var t=$(this),n=t.attr("data-rank");if("none"===n)i.attr("data-rank","none").children("i").removeClass("rank-desc").removeClass("rank-asc"),t.attr("data-rank","desc").children("i").addClass("rank-desc");else{var e="desc"===n?"asc":"desc";t.attr("data-rank",e).children("i").removeClass("rank-"+n).addClass("rank-"+e)}});var e=n.siblings("nav");e.find(".limit select").on("change",function(t){o.pageNum=1,o.pageSize=parseInt(t.target.value),s(a,o,r)});var c=e.find("ul.pagination");if(c.on("click",".page-item",function(){var t=parseInt(c.find(".page-item:not(.prev):not(.next)").last().text()),n=$(this),e=o.pageNum;n.hasClass("prev")?o.pageNum=o.pageNum-1||1:n.hasClass("next")?o.pageNum=(o.pageNum+1)%(t+1)||t:n.hasClass("else")||(o.pageNum=parseInt(n.text())||1),e!==o.pageNum&&s(a,o,r)}),/bonus/i.test(a)||r.on("click","tr",function(t){var n=t.target.tagName;if(/tr|td/i.test(n)){var e=$(this).closest("tr"),a=e.attr("data-id"),o=e.attr("data-type"),r=$('\n          <form\n            action="fileData/fileDataDetail"\n            method="post"\n            target="_blank"\n            rel="noopener noreferrer"\n            style="display:none"\n          >\n            <input name="fileDataId" value="'.concat(a,'" />\n            <input name="fileDataType" value="').concat(o,'" />\n          </form>\n        '));$(document.body).append(r),r.submit().remove()}}),/star/i.test(a))for(var d in t)"function"==typeof t[d]&&r.on("click","button[data-action=".concat(d,"]"),t[d]);/bonus/i.test(a)&&n.find(".dropdown").on("click",".dropdown-item",function(){o.integralType=$(this).attr("data-type"),s(a,o,r)})}function s(n,t,e){var a,c,d,o,s,l,r,u,p;/upload/i.test(n)?(e.html(""),r=t,u=function(t){return t.map(function(t){return e.append('\n      <tr data-id="'.concat((n=t).id,'" data-type="').concat(n.type,'">\n        <td\n          class="text-left"\n          title="').concat(n.title,'"\n        >\n          <div class="text-ellipsis">').concat(n.title,"</div>\n        </td>\n        <td>").concat(n.date,"</td>\n        <td>").concat(n.size,"</td>\n        <td>").concat(n.typeStr,"</td>\n        <td>").concat(n.cate,"</td>\n        <td>").concat(n.brand,"</td>\n        <td>").concat(n.state,'</td>\n        <td class="text-right">').concat(n.download,"</td>\n      </tr>\n    "));var n})},p=function(t){return i(n,t)},$.post("account/queryMyUploads",r,function(t){handleResult(t,function(t){var n=t.pageNum,e=t.total,a=t.pages,o=t.list,r={pageNum:n,total:e,pages:a},i=o.map(function(t){return{id:t.fileDataId,title:t.fileName,date:t.uploadTimeDesc,size:t.fileSize+" MB",type:t.fileDataType,typeStr:t.fileDataTypeDesc,cate:t.classTwoDesc,brand:t.brandDesc,state:t.fileDataStatusDesc,download:t.downloadCount}});"function"==typeof u&&u(i),"function"==typeof p&&p(r)})})):/star/i.test(n)?(e.html(""),o=t,s=function(t){return t.map(function(t){return e.append('\n      <tr data-id="'.concat((n=t).id,'" data-type="').concat(n.type,'">\n        <td\n          class="text-left"\n          title="').concat(n.title,'"\n        >\n          <div class="text-ellipsis">').concat(n.title,"</div>\n        </td>\n        <td>").concat(n.date,"</td>\n        <td>").concat(n.size,"</td>\n        <td>").concat(n.typeStr,"</td>\n        <td>").concat(n.cate,"</td>\n        <td>").concat(n.brand,"</td>\n        <td>").concat(n.state,"</td>\n        <td>").concat(n.bonus,'</td>\n        <td class="text-right">').concat(n.download,'</td>\n        <td class="td-actions text-right">\n          <button\n            data-action="star"\n            data-toggle="').concat(n.fav?"unstar":"star",'"\n            type="button"\n            class="btn btn-warning"\n            title="').concat(n.fav?"取消":"",'收藏"\n          >\n            <i class="material-icons">star').concat(n.fav?"":"_border",'</i>\n          </button>\n          <button\n            data-action="download"\n            type="button"\n            class="btn btn-success"\n            title="下载"\n          >\n            <i class="material-icons">get_app</i>\n          </button>\n        </td>\n      </tr>\n    '));var n})},l=function(t){return i(n,t)},$.post("account/queryMyFavorites",o,function(t){handleResult(t,function(t){var n=t.pageNum,e=t.total,a=t.pages,o=t.list,r={pageNum:n,total:e,pages:a},i=o.map(function(t){return{id:t.fileDataId,title:t.fileName,date:t.dataTimeDesc,size:t.fileSize+" MB",type:t.fileDataType,typeStr:t.fileDataTypeDesc,cate:t.classTwoDesc,brand:t.brandDesc,state:t.fileDataStatusDesc,bonus:t.requiredIntegral,download:t.downloadCount,fav:!0}});"function"==typeof s&&s(i),"function"==typeof l&&l(r)})})):/bonus/i.test(n)&&(e.html(""),a=t,c=function(t){return t.map(function(t){return e.append("\n      <tr>\n        <td>".concat((n=t).time,"</td>\n        <td>").concat(n.type,"</td>\n        <td>").concat(n.remark,"</td>\n        <td>").concat(n.operand," ").concat(n.bonus,"</td>\n      </tr>\n    "));var n})},d=function(t){return i(n,t)},$.post("account/queryMyIntegrals",a,function(t){handleResult(t,function(t){var n=t.pageNum,e=t.total,a=t.pages,o=t.list,r={pageNum:n,total:e,pages:a},i=o.map(function(t){return{time:t.addTimeDesc,type:t.integralTypeDesc,remark:t.description,bonus:t.integral,operand:1===parseInt(t.inOutType)?"+":"-"}});"function"==typeof c&&c(i),"function"==typeof d&&d(r)})}))}function i(t,n){var e=$(t).siblings("nav").find("ul.pagination");e.find("li.page-item:not(.prev):not(.next)").remove();var a=e.find(".page-item.next"),o=n.pages,r=n.pageNum;if(o<=10)for(var i=1;i<=o;++i)$(c(i,r)).insertBefore(a);else r<=3?($(c(1,r)).insertBefore(a),$(c(2,r)).insertBefore(a),$(c(3,r)).insertBefore(a),$(c("...",r)).insertBefore(a)):o-2<=r?($(c(1,r)).insertBefore(a),$(c("...",r)).insertBefore(a),$(c(o-2,r)).insertBefore(a),$(c(o-1,r)).insertBefore(a)):($(c(1,r)).insertBefore(a),$(c("...",r)).insertBefore(a),$(c(r-1,r)).insertBefore(a),$(c(r,r)).insertBefore(a),$(c(r+1,r)).insertBefore(a),$(c("...",r)).insertBefore(a)),$(c(o,r)).insertBefore(a);function c(t,n){return'\n        <li class="page-item '.concat(n===t?"active":""," ").concat("..."===t?"else":"",'">\n          <a class="page-link">').concat(t,"</a>\n        </li>\n      ")}}$(function(){var n;$('[data-toggle="popover"]').popover(),$("#downloadModal #downloadBtn").on("click",function(){$("#downloadModal").modal("hide")}),$.post("account/queryAccountInfo",function(t){handleResult(t,function(t){var n=t.account,e=t.enterprise,a=t.integral,o=t.uploadFileCount,r=t.beDownloadFileCount,i=$(".card.user"),c=i.find(".card-header");c.find("h3").text(n),c.find("h4").text(e);var d=i.find(".stats p");d.eq(0).text(a),d.eq(1).text(o),d.eq(2).text(r)})}),t("#table_upload"),t("#table_star",{star:function(){var t=$(this),n=t.attr("data-toggle");"star"===n?(t.attr({"data-toggle":"unstar",title:"取消收藏"}).children(".material-icons").text("star"),$.toast(_objectSpread({heading:"收藏成功"},e))):"unstar"===n&&(t.attr({"data-toggle":"star",title:"收藏"}).children(".material-icons").text("star_border"),$.toast(_objectSpread({heading:"已取消收藏"},e)))},download:function(){var t=$(this).closest("tr").find("td:nth-child(8)").text();0<parseInt(t)&&$("#downloadModal").modal()}}),t("#table_bonus"),(n=$("#table_bonus .dropdown .dropdown-menu")).html('\n      <a\n        tabindex="-1"\n        data-type="0"\n        class="dropdown-item"\n      >\n        全部类型\n      </a>\n      <div class="dropdown-divider"></div>\n    '),JSON.parse(bonusMenuStr).map(function(t){n.append('\n        <a\n          tabindex="-1"\n          data-type="'.concat(t.value,'"\n          class="dropdown-item"\n        >\n          ').concat(t.text,"\n        </a>\n      "))})})}();