"use strict";function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(e){_defineProperty(t,e,a[e])})}return t}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}!function(){function n(e,t){$.post("account/doFavorites",e,function(e){handleResult(e,t)})}function i(e){var t=$("base").attr("href")+"fileData/doFileDownload";$.fileDownload(t,{httpMethod:"POST",data:e})}$(function(){var e;e=1===fileType?"base":"analysis",$('nav.navbar .navbar-nav .nav-link[href*="'.concat(e,'"]')).parent().addClass("active").siblings().removeClass("active"),$("nav ol.breadcrumb li.breadcrumb-item").eq(0).html('\n      <a href="fileData/'.concat(2===fileType?"analysis":"base",'FileData">\n        ').concat(2===fileType?"解析":"原始","文件库\n      </a>\n    ")),$(".card .star").on("click",function(){var e=$(this),t=e.attr("data-toggle"),a={icon:"success",position:"bottom-right",allowToastClose:!1,stack:!1,loader:!1,hideAfter:2e3,textAlign:"center"};$.toast().reset("all"),"star"===t?n({fileDataId:fileId,fileDataType:fileType,opsFavoritesType:1},function(){e.attr({"data-toggle":"unstar",title:"取消收藏"}).children(".material-icons").text("star"),$.toast(_objectSpread({heading:"收藏成功"},a))}):"unstar"===t&&n({fileDataId:fileId,fileDataType:fileType,opsFavoritesType:2},function(){e.attr({"data-toggle":"star",title:"收藏"}).children(".material-icons").text("star_border"),$.toast(_objectSpread({heading:"已取消收藏"},a))})}),$(".card ul.author").on("click",".download",function(){var e,t,a=$("#downloadModal"),n={fileDataId:fileId,fileDataType:fileType};e=n,t=function(e){parseInt(e.requiredIntegral,10)?(a.find(".modal-body").html('\n              使用<b class="cost"> '.concat(e.requiredIntegral,' 积分</b>下载此文件？\n              当前积分余额：<b class="remain">').concat(e.currentIntegral," 积分</b>。\n            ")),a.modal(),a.one("click","#downloadBtn",function(){i(n),a.modal("hide")})):i(n)},$.post("fileData/checkFileDownload",e,function(e){handleResult(e,t)})}).on("click",".preview",function(){var e=$("base").attr("href"),t="".concat(e,"fileData/queryChartImg?fileDataId=").concat(fileId);window.open(t)}),$.post("fileData/queryFileDataDetail",{fileDataId:fileId,fileDataType:fileType},function(e){handleResult(e,function(e){var t=e.fileDataTypeDesc,a=e.account,n=e.enterprise,i=e.fileName,o=e.fileSizeDesc,r=e.dataTimeDesc,l=e.downloadCount,c=e.favoriteStatus,s=e.requiredIntegral,f=e.remark,d=e.classOneDesc,u=e.classTwoDesc,p=e.brandDesc,m=e.model,g=e.standard,v=e.pattern,h=e.ratedV,b=e.ratedI,y=e.ratedP,D=e.equipmentBrand,x=e.equipmentModel,I=e.samplingRate,q=e.variableRatio,T=e.unitV,w=e.unitI,B=$(".card:first-of-type"),N=B.find(".card-body");B.find(".star").attr({title:1===c?"取消收藏":"收藏","data-toggle":1===c?"unstar":"star"}).children("i").text(1===c?"star":"star_border"),N.find(".card-title").text(i),N.find(".intro").text(f);var k="<li>需 ".concat(s," 积分</li>");N.find(".author").html("\n              <li>".concat(a,"</li>\n              <li>").concat(n,"</li>\n              <li>").concat(r,"</li>\n              <li>").concat(t,"</li>\n              <li>").concat(l," 次下载</li>\n              ").concat(0<parseInt(s,10)?k:"","\n              ").concat(2===fileType?'\n              <li title="预览" class="preview">\n                <i class="material-icons">image</i>\n                预览\n              </li>\n            ':"",'\n              <li title="下载" class="download">\n                <i class="material-icons">get_app</i>\n                ').concat(o,"\n              </li>\n            "));var C=N.find(".stat .part"),O=C.eq(0).find(".row .row div:last-child");O.eq(0).text("".concat(d,"/").concat(u)),O.eq(1).text(p),O.eq(2).text(m),O.eq(3).text(g),O.eq(4).text(v),O.eq(5).text("".concat(h,"/").concat(b)),O.eq(6).text(y);var S=C.eq(1).find(".row .row div:last-child");S.eq(0).text(D),S.eq(1).text(x),S.eq(2).text(I),S.eq(3).text(q),S.eq(4).text(T),S.eq(5).text(w)})}),function(){var n={fileDataId:fileId,fileDataType:fileType,pageNum:1,pageSize:10},e=$(".card"),o=e.find(".comment-list"),l=o.find("ul.comment"),t=e.find(".publish"),a=t.find("textarea");t.find("button.send").on("click",function(){var e,t;e={fileDataId:fileId,fileDataType:fileType,content:a.val().trim()},t=function(){a.val(""),n.pageNum=1,r(n)},$.post("account/doComment",e,function(e){handleResult(e,t)})});var i=o.find("ul.pagination");function r(e){$.post("account/queryComments",e,function(e){handleResult(e,function(e){var t=e.pageNum,a=e.total,n=e.pages,i=e.list;o.find(".card-title").text("评论（".concat(i.length,"）")),l.html(""),i.map(function(e){var t;l.append((t={user:e.account,time:e.commentTimeDes,content:e.content},'\n        <li class="row">\n          <div class="icon">\n            <i class="material-icons">face</i>\n          </div>\n          <div class="col">\n            <h4>'.concat(t.user,"</h4>\n            <span>").concat(t.time,"</span>\n            <p>").concat(t.content,"</p>\n          </div>\n        </li>\n      ")))}),function(e){var t=l.siblings("nav").find("ul.pagination");t.find("li.page-item:not(.prev):not(.next)").remove();var a=t.find(".page-item.next"),n=e.pages,i=e.pageNum;if(n<=10)for(var o=1;o<=n;++o)$(r(o,i)).insertBefore(a);else i<=3?($(r(1,i)).insertBefore(a),$(r(2,i)).insertBefore(a),$(r(3,i)).insertBefore(a),$(r("...",i)).insertBefore(a)):n-2<=i?($(r(1,i)).insertBefore(a),$(r("...",i)).insertBefore(a),$(r(n-2,i)).insertBefore(a),$(r(n-1,i)).insertBefore(a)):($(r(1,i)).insertBefore(a),$(r("...",i)).insertBefore(a),$(r(i-1,i)).insertBefore(a),$(r(i,i)).insertBefore(a),$(r(i+1,i)).insertBefore(a),$(r("...",i)).insertBefore(a)),$(r(n,i)).insertBefore(a);function r(e,t){return'\n          <li class="page-item '.concat(t===e?"active":""," ").concat("..."===e?"else":"",'">\n            <a class="page-link">').concat(e,"</a>\n          </li>\n        ")}}({pageNum:t,total:a,pages:n})})})}i.on("click",".page-item",function(){var e=parseInt(i.find(".page-item:not(.prev):not(.next)").last().text(),10),t=$(this),a=n.pageNum;t.hasClass("prev")?n.pageNum=n.pageNum-1||1:t.hasClass("next")?n.pageNum=(n.pageNum+1)%(e+1)||e:t.hasClass("else")||(n.pageNum=parseInt(t.text(),10)||1),a!==n.pageNum&&r(n)}),r(n)}()})}();